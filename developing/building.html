<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Stats and Analytics" href="stats.html" /><link rel="prev" title="How Tos" href="how_tos.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Build Processes - Knowledge Commons Works 0.4.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Knowledge Commons Works 0.4.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Knowledge Commons Works 0.4.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../README.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../feature_highlights.html">Feature Highlights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../known_issues.html">Known Issues</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../admin_guide/index.html">Administrator Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Administrator Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../admin_guide/moderation.html">Content Moderation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../setup/index.html">Setting up KCWorks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Setting up KCWorks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../setup/configuration.html">Configuration of KCWorks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/installation.html">Installation</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Developing KCWorks</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Developing KCWorks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="architecture.html">KCWorks Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_standards.html">Development Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="source_control.html">Source Control and Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow.html">Development Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Automated Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_tos.html">How Tos</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Build Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html">Stats and Analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html">I18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="infrastructure.html">KCWorks Infrastructure</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/metadata.html">Metadata Schema, Vocabularies, and Identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/api.html">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli_commands.html">CLI Commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../customizations.html">Customizations to InvenioRDM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../in_depth.html">In-depth Installation Instructions (NEEDS UPDATING)</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/developing/building.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="build-processes">
<h1>Build Processes<a class="headerlink" href="#build-processes" title="Link to this heading">¶</a></h1>
<section id="building-the-documentation">
<h2>Building the Documentation<a class="headerlink" href="#building-the-documentation" title="Link to this heading">¶</a></h2>
<p>The documentation is built using Sphinx. The documentation source files are located in the <code class="docutils literal notranslate"><span class="pre">docs/source</span></code> directory.</p>
<p>To build the documentation, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sphinx-build<span class="w"> </span>-b<span class="w"> </span>html<span class="w"> </span>docs/source<span class="w"> </span>docs/build/html
</pre></div>
</div>
<p>This will build the documentation and save it in the <code class="docutils literal notranslate"><span class="pre">docs/build/html</span></code> directory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The documentation is built automatically and published to the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch when a change is pushed or PR is merged into the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p>
</div>
</section>
<section id="building-js-css-and-other-static-assets">
<h2>Building JS, CSS, and Other Static Assets<a class="headerlink" href="#building-js-css-and-other-static-assets" title="Link to this heading">¶</a></h2>
<p>InvenioRDM, the foundation for KCWorks, generally bundles its frontend asset file as part of its python packages. This means that the JavaScript and CSS (and .less and .scss files) cannot simply be installed as npm dependencies. They must be gathered from the python packages and built in a central location. Similarly, where those js files depend on npm packages, the various python packages can declare their own JavaScript dependencies, which must be included in that central build.</p>
<section id="build-script-and-cli-commands">
<h3>Build script and CLI commands<a class="headerlink" href="#build-script-and-cli-commands" title="Link to this heading">¶</a></h3>
<p>The full build process is handled in KCWorks by the <code class="docutils literal notranslate"><span class="pre">scripts/build-assets.sh</span></code> script, intended to be run inside the <code class="docutils literal notranslate"><span class="pre">web-ui</span></code> container. This script handles the following commands from InvenioRDM’s standard build process:</p>
<p>From the KCWorks source directory, the script runs the following commands:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span></code> commands are aliases for the <code class="docutils literal notranslate"><span class="pre">flask</span> <span class="pre">webpack</span></code> commands. These are defined by the <code class="docutils literal notranslate"><span class="pre">flask-webpackext</span></code> package. But InvenioRDM exposes all flask commands using the <code class="docutils literal notranslate"><span class="pre">invenio</span></code> prefix as an alias for the <code class="docutils literal notranslate"><span class="pre">flask</span></code> prefix.</p>
</div>
<section id="invenio-webpack-collect-v">
<h4>1. <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span> <span class="pre">collect</span> <span class="pre">-v</span></code><a class="headerlink" href="#invenio-webpack-collect-v" title="Link to this heading">¶</a></h4>
<img src="../_static/static_build_process_collect.jpg" alt="webpack collect" width="100%"/>
<p>Gathers static files that don’t require building from the python packages, based on the static files locations defined in the application’s blueprints. These files are placed in the <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static</span></code> directory and are exposed at the <code class="docutils literal notranslate"><span class="pre">/static</span></code> URL.</p>
</section>
<section id="invenio-webpack-clean-create">
<h4>2. <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span> <span class="pre">clean</span> <span class="pre">create</span></code><a class="headerlink" href="#invenio-webpack-clean-create" title="Link to this heading">¶</a></h4>
<img src="../_static/static_build_process_create.jpg" alt="webpack clean create" width="100%"/>
<p>This performs four actions to set up for the build:</p>
<ul class="simple">
<li><p>Deletes the existing built assets directory (<code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static/dist</span></code>).</p></li>
<li><p>Copies all asset source files to the central Webpack build context directory (<code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/assets</span></code>). This covers all of the files that need to be built by Webpack</p></li>
<li><p>Symlinks the <code class="docutils literal notranslate"><span class="pre">webpack.config.js</span></code> file supplied by <code class="docutils literal notranslate"><span class="pre">invenio-assets</span></code> into the <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/assets/build</span></code> directory.</p></li>
<li><p>Generates a new <code class="docutils literal notranslate"><span class="pre">package.json</span></code> file in the top-level <code class="docutils literal notranslate"><span class="pre">assets</span></code> directory. This begins with the base package.json provided by <code class="docutils literal notranslate"><span class="pre">invenio-assets</span></code> and injects all of the additional npm dependencies declared in the <code class="docutils literal notranslate"><span class="pre">invenio_assets.webpack</span></code> entrypoints.</p></li>
<li><p>Creates a new <code class="docutils literal notranslate"><span class="pre">config.js</span></code> file (in the <code class="docutils literal notranslate"><span class="pre">/opt/invenio/src/assets/build</span></code> directory) that can by imported by the <code class="docutils literal notranslate"><span class="pre">webpack.config.js</span></code> and provides Webpack with</p>
<ul>
<li><p>the <code class="docutils literal notranslate"><span class="pre">build</span></code> context providing directory paths for the gathered source files (<code class="docutils literal notranslate"><span class="pre">assets/build</span></code>) and final built files (<code class="docutils literal notranslate"><span class="pre">static/dist</span></code>) as well as any other static files (<code class="docutils literal notranslate"><span class="pre">static</span></code>)</p></li>
<li><p>the cumulative list of <code class="docutils literal notranslate"><span class="pre">aliases</span></code> that allow Webpack to find files in the subfolders of <code class="docutils literal notranslate"><span class="pre">assets</span></code> via <code class="docutils literal notranslate"><span class="pre">../../less</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;js</span></code>, etc.</p></li>
<li><p>the webpack <code class="docutils literal notranslate"><span class="pre">entry</span></code> points, which are the files that will be built by Webpack. (Not to be confused with the python <code class="docutils literal notranslate"><span class="pre">entrypoints</span></code> defined by <code class="docutils literal notranslate"><span class="pre">invenio_assets.webpack</span></code>.)</p></li>
</ul>
</li>
</ul>
<p>(Under the hood these steps are all handled by <code class="docutils literal notranslate"><span class="pre">pywebpack</span></code> via <code class="docutils literal notranslate"><span class="pre">flask_webpackext</span></code> and the <code class="docutils literal notranslate"><span class="pre">WebpackBundleProject</span></code> class.)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">clean</span></code> subcommand instructs invenio-assets to delete the existing built assets directory (<code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static/dist</span></code>) and recreate it. If you want to keep the existing build assets and simply copy into it, you can use the <code class="docutils literal notranslate"><span class="pre">create</span></code> subcommand without the <code class="docutils literal notranslate"><span class="pre">clean</span></code> subcommand.</p>
</section>
<section id="invenio-webpack-install">
<h4>3. <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span> <span class="pre">install</span></code><a class="headerlink" href="#invenio-webpack-install" title="Link to this heading">¶</a></h4>
<img src="../_static/static_build_process_install.jpg" alt="webpack install" width="100%"/>
<p>Runs the <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">install</span></code> defined in the newly assembled <code class="docutils literal notranslate"><span class="pre">package.json</span></code> file in <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/assets</span></code>. Dependencies are downloaded into <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/assets/node_modules</span></code>.</p>
</section>
<section id="cd-opt-invenio-src-invenio-shell-opt-invenio-src-scripts-symlink-assets-py">
<h4>4. <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">/opt/invenio/src</span> <span class="pre">&amp;&amp;</span> <span class="pre">invenio</span> <span class="pre">shell</span> <span class="pre">/opt/invenio/src/scripts/symlink_assets.py</span></code><a class="headerlink" href="#cd-opt-invenio-src-invenio-shell-opt-invenio-src-scripts-symlink-assets-py" title="Link to this heading">¶</a></h4>
<img src="../_static/static_build_process_symlink.jpg" alt="webpack symlink" width="100%"/>
<p>This symlinks all of the files in the source <code class="docutils literal notranslate"><span class="pre">assets</span></code> directory (<code class="docutils literal notranslate"><span class="pre">/opt/invenio/src/assets</span></code>) to the <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/assets</span></code> directory. This includes all js, less, and scss files, as well as the translations directory. These files are not included in the installable <code class="docutils literal notranslate"><span class="pre">kcworks</span></code> python package, and so were not included earlier in the file discovery and project assembly that flask_webpackext performs based on entry points.</p>
</section>
<section id="invenio-webpack-build">
<h4>5. <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span> <span class="pre">build</span></code><a class="headerlink" href="#invenio-webpack-build" title="Link to this heading">¶</a></h4>
<img src="../_static/static_build_process_build.jpg" alt="webpack build" width="100%"/>
<p>Runs <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">run</span> <span class="pre">build</span></code> command to execute the webpack command defined in the <code class="docutils literal notranslate"><span class="pre">package.json</span></code> file. This builds the assets, placing the built files in the <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static/dist</span></code> directory.</p>
<p>The actual webpack <code class="docutils literal notranslate"><span class="pre">build</span></code> command is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">NODE_PRESERVE_SYMLINKS</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">npm_config_report</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">NODE_ENV</span><span class="o">=</span>production<span class="p">|</span>development<span class="w"> </span>webpack<span class="w"> </span>--config<span class="w"> </span>./build/webpack.config.js
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">webpack.config.js</span></code> in <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/assets/build</span></code> is the main config file controlling Webpack itself, supplemented with aliases and entries from the <code class="docutils literal notranslate"><span class="pre">config.js</span></code> file in the same directory. The build context (from <code class="docutils literal notranslate"><span class="pre">config.js</span></code>) is set to <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/assets</span></code>. The webpack command sets webpack <code class="docutils literal notranslate"><span class="pre">mode</span></code> as either “production” or “development” based on the value of the <code class="docutils literal notranslate"><span class="pre">NODE_ENV</span></code> environment variable.</p>
<p>The BundleTracker plugin in <code class="docutils literal notranslate"><span class="pre">webpack.config.js</span></code> writes the manifest file into the <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static/dist</span></code> directory to tell Python where the built assets are located.</p>
<p>The resulting <code class="docutils literal notranslate"><span class="pre">dist</span></code> folder, holding the compiled assets, is exposed at the <code class="docutils literal notranslate"><span class="pre">/static/dist/</span></code> URL.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In vanilla InvenioRDM, the <code class="docutils literal notranslate"><span class="pre">flask</span> <span class="pre">webpack</span> <span class="pre">buildall</span></code> command is used to run the <code class="docutils literal notranslate"><span class="pre">create</span></code>, <code class="docutils literal notranslate"><span class="pre">install</span></code>, and <code class="docutils literal notranslate"><span class="pre">build</span></code> commands in sequence. It does not run the <code class="docutils literal notranslate"><span class="pre">collect</span></code> command, and does not run the script to symlink the development assets.</p>
</div>
</section>
</section>
<section id="watching-files-for-changes">
<h3>Watching files for changes<a class="headerlink" href="#watching-files-for-changes" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">package.json</span></code> file in the <code class="docutils literal notranslate"><span class="pre">assets</span></code> directory includes the <code class="docutils literal notranslate"><span class="pre">start</span></code> script, which will be triggered by <code class="docutils literal notranslate"><span class="pre">flask</span> <span class="pre">webpack</span> <span class="pre">start</span></code> and runs webpack with the same config file but <code class="docutils literal notranslate"><span class="pre">NODE_ENV=development</span></code>. This will not minify the compiled assets, leaving them readable and easier to debug. This will also spin up the live reload plugin.</p>
</section>
<section id="key-file-locations">
<h3>Key file locations<a class="headerlink" href="#key-file-locations" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>config.js file in <code class="docutils literal notranslate"><span class="pre">/opt/invenio/src/assets/build/</span></code></p></li>
<li><p>built css and js files in <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static/dist/</span></code></p>
<ul>
<li><p>public url is <code class="docutils literal notranslate"><span class="pre">static/dist/</span></code></p></li>
</ul>
</li>
<li><p>static css and js files (not needing build) in <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static/css</span></code> and <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static/js</span></code></p>
<ul>
<li><p>public url is <code class="docutils literal notranslate"><span class="pre">static/css/</span></code> and <code class="docutils literal notranslate"><span class="pre">static/js/</span></code></p></li>
</ul>
</li>
<li><p>webpack build context is <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/assets/</span></code></p></li>
<li><p>manifest.json is <code class="docutils literal notranslate"><span class="pre">/opt/invenio/var/instance/static/dist/manifest.json</span></code></p></li>
</ul>
</section>
<section id="key-python-packages-involved">
<h3>Key python packages involved<a class="headerlink" href="#key-python-packages-involved" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>invenio-assets</p></li>
<li><p>flask-webpackext</p></li>
<li><p>flask-collect</p></li>
<li><p>pywebpack</p></li>
</ul>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="stats.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Stats and Analytics</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="how_tos.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">How Tos</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Mesh Research
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Build Processes</a><ul>
<li><a class="reference internal" href="#building-the-documentation">Building the Documentation</a></li>
<li><a class="reference internal" href="#building-js-css-and-other-static-assets">Building JS, CSS, and Other Static Assets</a><ul>
<li><a class="reference internal" href="#build-script-and-cli-commands">Build script and CLI commands</a><ul>
<li><a class="reference internal" href="#invenio-webpack-collect-v">1. <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span> <span class="pre">collect</span> <span class="pre">-v</span></code></a></li>
<li><a class="reference internal" href="#invenio-webpack-clean-create">2. <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span> <span class="pre">clean</span> <span class="pre">create</span></code></a></li>
<li><a class="reference internal" href="#invenio-webpack-install">3. <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span> <span class="pre">install</span></code></a></li>
<li><a class="reference internal" href="#cd-opt-invenio-src-invenio-shell-opt-invenio-src-scripts-symlink-assets-py">4. <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">/opt/invenio/src</span> <span class="pre">&amp;&amp;</span> <span class="pre">invenio</span> <span class="pre">shell</span> <span class="pre">/opt/invenio/src/scripts/symlink_assets.py</span></code></a></li>
<li><a class="reference internal" href="#invenio-webpack-build">5. <code class="docutils literal notranslate"><span class="pre">invenio</span> <span class="pre">webpack</span> <span class="pre">build</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#watching-files-for-changes">Watching files for changes</a></li>
<li><a class="reference internal" href="#key-file-locations">Key file locations</a></li>
<li><a class="reference internal" href="#key-python-packages-involved">Key python packages involved</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=6c02275b"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>